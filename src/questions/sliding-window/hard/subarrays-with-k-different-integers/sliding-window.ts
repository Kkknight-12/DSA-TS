/**
 * SUBARRAYS WITH K DIFFERENT INTEGERS - SLIDING WINDOW (OPTIMAL)
 * ==============================================================
 *
 * THE BRILLIANT TRICK: exactly(K) = atMost(K) - atMost(K-1)
 *
 * INTUITION (Soch):
 * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 * "Exactly K distinct" sliding window mein directly handle karna mushkil hai kyunki:
 * - Window invalid ho sakti hai DONO sides se (too many OR too few distinct)
 * - Standard sliding window sirf EK direction se invalid hoti hai
 *
 * TRICK:
 * - atMost(K) counts subarrays with: 1, 2, 3, ..., K distinct
 * - atMost(K-1) counts subarrays with: 1, 2, 3, ..., K-1 distinct
 * - Subtract karo â†’ ONLY subarrays with EXACTLY K distinct remain!
 *
 * Visual:
 * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 * â”‚                        atMost(K)                                    â”‚
 * â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
 * â”‚  â”‚           atMost(K-1)                â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
 * â”‚  â”‚                                      â”‚  â”‚   EXACTLY K        â”‚  â”‚
 * â”‚  â”‚  distinct: 1, 2, 3, ..., K-1         â”‚  â”‚   (what remains!)  â”‚  â”‚
 * â”‚  â”‚                                      â”‚  â”‚                    â”‚  â”‚
 * â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
 * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 *
 * TIME COMPLEXITY: O(n) - two passes of O(n) each
 * SPACE COMPLEXITY: O(k) - hashmap with at most k+1 elements
 */

namespace SubarraysWithKDistinctSlidingWindow {
  /**
   * Main function - exactly K distinct using the subtraction trick
   *
   * @param nums - Array of integers
   * @param k - Exact number of distinct integers required
   * @returns Count of subarrays with exactly k distinct integers
   */
  function subarraysWithKDistinct(nums: number[], k: number): number {
    // THE MAGIC FORMULA:
    // exactly(K) = atMost(K) - atMost(K-1)
    //
    // WHY?
    // atMost(K) mein 1, 2, ..., K distinct wale sab counted hain
    // atMost(K-1) mein 1, 2, ..., K-1 distinct wale counted hain
    // Subtract karo â†’ sirf EXACTLY K distinct wale bachenge!

    return atMostK(nums, k) - atMostK(nums, k - 1);
  }

  /**
   * Helper function - counts subarrays with AT MOST k distinct integers
   *
   * PATTERN:
   * - For each right position, expand window
   * - If distinct > k, shrink from left
   * - count += (right - left + 1) â†’ all subarrays ENDING at right
   *
   * @param nums - Array of integers
   * @param k - Maximum number of distinct integers allowed
   * @returns Count of subarrays with at most k distinct integers
   */
  function atMostK(nums: number[], k: number): number {
    // Edge Case: k <= 0 means no valid subarrays possible
    // WHY: We can't have subarray with 0 or negative distinct elements
    if (k <= 0) return 0;

    const n = nums.length;
    let count = 0; // Total count of valid subarrays
    let left = 0; // Left boundary of window

    // Frequency map to track distinct elements
    // KEY: element value, VALUE: count in current window
    // Map.size = number of distinct elements
    const freq: Map<number, number> = new Map();

    // Expand window by moving right pointer
    for (let right = 0; right < n; right++) {
      const numRight = nums[right];

      // STEP 1: Add nums[right] to window
      // Update frequency map
      freq.set(numRight, (freq.get(numRight) || 0) + 1);

      // STEP 2: Shrink window if distinct > k
      // Keep removing from left until valid
      while (freq.size > k) {
        const numLeft = nums[left];

        // Decrease frequency of left element
        const newFreq = freq.get(numLeft)! - 1;

        if (newFreq === 0) {
          // CRITICAL: If frequency becomes 0, DELETE the key!
          // This reduces map.size (distinct count)
          freq.delete(numLeft);
        } else {
          freq.set(numLeft, newFreq);
        }

        // Move left pointer forward
        left++;
      }

      // STEP 3: Count all subarrays ENDING at 'right'
      //
      // WHY (right - left + 1)?
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // Current valid window: [left, left+1, ..., right]
      // All subarrays ending at 'right' with â‰¤ k distinct:
      //   [left..right], [left+1..right], ..., [right..right]
      //
      // That's (right - left + 1) subarrays!
      //
      // EXAMPLE: nums = [1,2,1], k = 2, right = 2
      //   Window: [1,2,1] (indices 0-2), left = 0
      //   Subarrays ending at index 2:
      //     - [1,2,1] (start=0) â†’ 2 distinct âœ…
      //     - [2,1] (start=1) â†’ 2 distinct âœ…
      //     - [1] (start=2) â†’ 1 distinct âœ…
      //   count += 3 = (2 - 0 + 1)
      count += right - left + 1;
    }

    return count;
  }

  /**
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * DRY RUN - COMPLETE VISUALIZATION
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * Example: nums = [1, 2, 1, 2, 3], k = 2
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * STEP 1: Calculate atMostK(nums, 2)
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * Initial: left = 0, count = 0, freq = {}
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=0: nums[0]=1                                                         â”‚
   * â”‚   freq = {1:1}, size=1 â‰¤ 2 âœ…                                              â”‚
   * â”‚   count += 0-0+1 = 1                                                       â”‚
   * â”‚   Subarrays counted: [1]                                                   â”‚
   * â”‚   Window: [1] 2 1 2 3                                                      â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=1: nums[1]=2                                                         â”‚
   * â”‚   freq = {1:1, 2:1}, size=2 â‰¤ 2 âœ…                                         â”‚
   * â”‚   count += 1-0+1 = 2 â†’ total=3                                            â”‚
   * â”‚   Subarrays counted: [1,2], [2]                                           â”‚
   * â”‚   Window: [1 2] 1 2 3                                                      â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=2: nums[2]=1                                                         â”‚
   * â”‚   freq = {1:2, 2:1}, size=2 â‰¤ 2 âœ…                                         â”‚
   * â”‚   count += 2-0+1 = 3 â†’ total=6                                            â”‚
   * â”‚   Subarrays counted: [1,2,1], [2,1], [1]                                  â”‚
   * â”‚   Window: [1 2 1] 2 3                                                      â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=3: nums[3]=2                                                         â”‚
   * â”‚   freq = {1:2, 2:2}, size=2 â‰¤ 2 âœ…                                         â”‚
   * â”‚   count += 3-0+1 = 4 â†’ total=10                                           â”‚
   * â”‚   Subarrays counted: [1,2,1,2], [2,1,2], [1,2], [2]                       â”‚
   * â”‚   Window: [1 2 1 2] 3                                                      â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=4: nums[4]=3                                                         â”‚
   * â”‚   freq = {1:2, 2:2, 3:1}, size=3 > 2 âŒ                                    â”‚
   * â”‚                                                                            â”‚
   * â”‚   SHRINK LOOP:                                                             â”‚
   * â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   * â”‚   â”‚ left=0: remove nums[0]=1                                           â”‚  â”‚
   * â”‚   â”‚   freq = {1:1, 2:2, 3:1}, size=3 > 2, left=1                       â”‚  â”‚
   * â”‚   â”‚                                                                     â”‚  â”‚
   * â”‚   â”‚ left=1: remove nums[1]=2                                           â”‚  â”‚
   * â”‚   â”‚   freq = {1:1, 2:1, 3:1}, size=3 > 2, left=2                       â”‚  â”‚
   * â”‚   â”‚                                                                     â”‚  â”‚
   * â”‚   â”‚ left=2: remove nums[2]=1                                           â”‚  â”‚
   * â”‚   â”‚   freq[1]=0 â†’ DELETE 1                                             â”‚  â”‚
   * â”‚   â”‚   freq = {2:1, 3:1}, size=2 â‰¤ 2 âœ… STOP, left=3                    â”‚  â”‚
   * â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   * â”‚                                                                            â”‚
   * â”‚   count += 4-3+1 = 2 â†’ total=12                                           â”‚
   * â”‚   Subarrays counted: [2,3], [3]                                           â”‚
   * â”‚   Window: 1 2 1 [2 3]                                                      â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * atMostK(nums, 2) = 12
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * STEP 2: Calculate atMostK(nums, 1)
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * Initial: left = 0, count = 0, freq = {}
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=0: nums[0]=1                                                         â”‚
   * â”‚   freq = {1:1}, size=1 â‰¤ 1 âœ…                                              â”‚
   * â”‚   count += 1 â†’ total=1                                                    â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=1: nums[1]=2                                                         â”‚
   * â”‚   freq = {1:1, 2:1}, size=2 > 1 âŒ                                         â”‚
   * â”‚   SHRINK: remove 1 â†’ freq={2:1}, left=1                                   â”‚
   * â”‚   count += 1 â†’ total=2                                                    â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=2: nums[2]=1                                                         â”‚
   * â”‚   freq = {2:1, 1:1}, size=2 > 1 âŒ                                         â”‚
   * â”‚   SHRINK: remove 2 â†’ freq={1:1}, left=2                                   â”‚
   * â”‚   count += 1 â†’ total=3                                                    â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=3: nums[3]=2                                                         â”‚
   * â”‚   freq = {1:1, 2:1}, size=2 > 1 âŒ                                         â”‚
   * â”‚   SHRINK: remove 1 â†’ freq={2:1}, left=3                                   â”‚
   * â”‚   count += 1 â†’ total=4                                                    â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚ right=4: nums[4]=3                                                         â”‚
   * â”‚   freq = {2:1, 3:1}, size=2 > 1 âŒ                                         â”‚
   * â”‚   SHRINK: remove 2 â†’ freq={3:1}, left=4                                   â”‚
   * â”‚   count += 1 â†’ total=5                                                    â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   * atMostK(nums, 1) = 5
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * STEP 3: FINAL CALCULATION
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * exactlyK(2) = atMostK(2) - atMostK(1)
   *             = 12 - 5
   *             = 7 âœ…
   *
   * The 7 subarrays with EXACTLY 2 distinct:
   * [1,2], [2,1], [1,2], [2,3], [1,2,1], [2,1,2], [1,2,1,2]
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * WHY (right - left + 1) WORKS
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * Socho: Jab window [left..right] valid hai (â‰¤ k distinct)
   *
   * Toh kitne subarrays END at 'right' with â‰¤ k distinct?
   *
   *   start=left:    [left, left+1, ..., right]     â† valid (has â‰¤ k)
   *   start=left+1:  [left+1, left+2, ..., right]   â† valid (has â‰¤ k)
   *   start=left+2:  [left+2, left+3, ..., right]   â† valid (has â‰¤ k)
   *   ...
   *   start=right:   [right]                         â† valid (has 1)
   *
   * Total: (right - left + 1) subarrays!
   *
   * YE COUNTING PATTERN IMPORTANT HAI:
   * - Hum SIRF right par end hone wale count karte hain
   * - Previous rights ke time already count ho chuke hain unke ending wale
   * - Is tarah se NO DOUBLE COUNTING!
   */

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // TEST CASES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  export function runTests(): void {
    console.log(
      'ğŸ§ª Testing Subarrays with K Different Integers - SLIDING WINDOW (OPTIMAL)\n'
    );

    const testCases: {
      nums: number[];
      k: number;
      expected: number;
      description: string;
    }[] = [
      // Basic examples from problem
      {
        nums: [1, 2, 1, 2, 3],
        k: 2,
        expected: 7,
        description: 'Example 1: Basic case',
      },
      {
        nums: [1, 2, 1, 3, 4],
        k: 3,
        expected: 3,
        description: 'Example 2: k=3',
      },
      {
        nums: [1, 1, 1, 1],
        k: 1,
        expected: 10,
        description: 'Example 3: All same elements',
      },

      // Edge cases
      {
        nums: [1],
        k: 1,
        expected: 1,
        description: 'Single element, k=1',
      },
      {
        nums: [1, 2],
        k: 2,
        expected: 1,
        description: 'Two elements, k=2',
      },
      {
        nums: [1, 2],
        k: 1,
        expected: 2,
        description: 'Two elements, k=1',
      },

      // More complex cases
      {
        nums: [1, 2, 3, 1, 2],
        k: 3,
        expected: 6,
        description: 'k equals total distinct',
      },
      {
        nums: [2, 1, 1, 1, 2],
        k: 1,
        expected: 8,
        description: 'Repeated elements',
      },
      {
        nums: [1, 2, 3, 4, 5],
        k: 2,
        expected: 4,
        description: 'All distinct, k=2',
      },

      // Large k
      {
        nums: [1, 2, 1, 2, 1, 2],
        k: 2,
        expected: 15,
        description: 'Alternating pattern',
      },
    ];

    let passed = 0;
    let failed = 0;

    for (const { nums, k, expected, description } of testCases) {
      const result = subarraysWithKDistinct(nums, k);
      const status = result === expected ? 'âœ…' : 'âŒ';

      if (result === expected) {
        passed++;
        console.log(`${status} ${description}`);
        console.log(`   Input: nums = [${nums}], k = ${k}`);
        console.log(`   Output: ${result}\n`);
      } else {
        failed++;
        console.log(`${status} ${description}`);
        console.log(`   Input: nums = [${nums}], k = ${k}`);
        console.log(`   Expected: ${expected}, Got: ${result}\n`);
      }
    }

    console.log('â•'.repeat(60));
    console.log(`ğŸ“Š Results: ${passed} passed, ${failed} failed`);
    console.log('â•'.repeat(60));
  }
}

// Run tests
SubarraysWithKDistinctSlidingWindow.runTests();