/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * LONGEST SUBSTRING WITH AT MOST K DISTINCT CHARACTERS - SLIDING WINDOW
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 *
 * Problem: Find the length of longest substring with at most k distinct characters
 *
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * SLIDING WINDOW INTUITION (Soch)
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 *
 * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 * â”‚                                                                            â”‚
 * â”‚  BRUTE FORCE PROBLEM: Nested loops â†’ O(nÂ²)                                â”‚
 * â”‚  - For each starting position, we scan forward                            â”‚
 * â”‚  - Repeated work! Overlapping substrings                                  â”‚
 * â”‚                                                                            â”‚
 * â”‚  SLIDING WINDOW OPTIMIZATION: Two pointers â†’ O(n)                         â”‚
 * â”‚  - Maintain a WINDOW [left, right]                                        â”‚
 * â”‚  - Expand right to include more characters                                â”‚
 * â”‚  - Shrink left when window becomes INVALID (distinct > k)                 â”‚
 * â”‚  - Each character processed at most TWICE (once add, once remove)         â”‚
 * â”‚                                                                            â”‚
 * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 *
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * THE SLIDING WINDOW PATTERN FOR "AT MOST K"
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 *
 * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 * â”‚                                                                            â”‚
 * â”‚  1. EXPAND: Move right pointer, add character to frequency map            â”‚
 * â”‚                                                                            â”‚
 * â”‚  2. SHRINK: While (distinct > k), remove from left until valid            â”‚
 * â”‚                                                                            â”‚
 * â”‚  3. UPDATE: After shrinking, window is valid â†’ update maxLength           â”‚
 * â”‚                                                                            â”‚
 * â”‚  KEY INSIGHT:                                                              â”‚
 * â”‚  - Map SIZE = number of DISTINCT characters in window                     â”‚
 * â”‚  - When map.size > k, window is invalid â†’ shrink                          â”‚
 * â”‚  - When map.size â‰¤ k, window is valid â†’ update max                        â”‚
 * â”‚                                                                            â”‚
 * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 *
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * VISUAL EXAMPLE
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 *
 *   s = "aababbcaacc", k = 2
 *
 *   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 *   â”‚                                                                         â”‚
 *   â”‚  right=0: [a]ababbcaacc    map={a:1}         size=1 â‰¤ 2 âœ…  len=1      â”‚
 *   â”‚            â†‘                                                           â”‚
 *   â”‚           L,R                                                          â”‚
 *   â”‚                                                                         â”‚
 *   â”‚  right=1: [aa]babbcaacc    map={a:2}         size=1 â‰¤ 2 âœ…  len=2      â”‚
 *   â”‚            â†‘â†‘                                                          â”‚
 *   â”‚           L R                                                          â”‚
 *   â”‚                                                                         â”‚
 *   â”‚  right=2: [aab]abbcaacc    map={a:2,b:1}     size=2 â‰¤ 2 âœ…  len=3      â”‚
 *   â”‚            â†‘ â†‘                                                         â”‚
 *   â”‚           L  R                                                         â”‚
 *   â”‚                                                                         â”‚
 *   â”‚  right=5: [aababb]caacc    map={a:3,b:3}     size=2 â‰¤ 2 âœ…  len=6 â­   â”‚
 *   â”‚            â†‘    â†‘                                                      â”‚
 *   â”‚           L     R                                                      â”‚
 *   â”‚                                                                         â”‚
 *   â”‚  right=6: [aababbc]aacc    map={a:3,b:3,c:1} size=3 > 2 âŒ             â”‚
 *   â”‚            â†‘     â†‘                                                     â”‚
 *   â”‚           L      R         SHRINK NEEDED!                              â”‚
 *   â”‚                                                                         â”‚
 *   â”‚  SHRINK until valid:                                                    â”‚
 *   â”‚  - Remove s[0]='a': map={a:2,b:3,c:1}, size=3, left=1                  â”‚
 *   â”‚  - Remove s[1]='a': map={a:1,b:3,c:1}, size=3, left=2                  â”‚
 *   â”‚  - Remove s[2]='b': map={a:1,b:2,c:1}, size=3, left=3                  â”‚
 *   â”‚  - Remove s[3]='a': map={b:2,c:1}, size=2 â‰¤ 2 âœ… STOP, left=4         â”‚
 *   â”‚                                                                         â”‚
 *   â”‚           aaba[bbc]aacc    map={b:2,c:1}     size=2 â‰¤ 2 âœ…  len=3      â”‚
 *   â”‚               â†‘  â†‘                                                     â”‚
 *   â”‚              L   R                                                     â”‚
 *   â”‚                                                                         â”‚
 *   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 *
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 *
 * Time Complexity: O(n) - each character added once, removed at most once
 * Space Complexity: O(k) - map stores at most k+1 distinct characters
 *
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

namespace LongestSubstringAtMostKDistinctSlidingWindow {
  /**
   * Find longest substring with at most k distinct characters - SLIDING WINDOW
   *
   * @param s - Input string
   * @param k - Maximum distinct characters allowed
   * @returns Length of longest valid substring
   */
  function lengthOfLongestSubstringKDistinct(s: string, k: number): number {
    const n = s.length;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // EDGE CASES
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    if (k === 0 || n === 0) return 0;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // FREQUENCY MAP: Track character counts in current window
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //
    // Key insight: map.size = number of DISTINCT characters
    // When map.size > k, window is invalid

    const freq: Map<string, number> = new Map();

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TWO POINTERS: Define the window [left, right]
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    let left = 0;
    let maxLength = 0;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // MAIN LOOP: Expand window by moving right pointer
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    for (let right = 0; right < n; right++) {
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // STEP 1: ADD character at right to the window
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      //
      // Increment frequency of s[right]
      // If it's a NEW character, map.size increases automatically

      const rightChar = s[right];
      const currentCount = freq.get(rightChar) || 0;
      freq.set(rightChar, currentCount + 1);

      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // STEP 2: SHRINK window while invalid (distinct > k)
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      //
      // â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      // â”‚  WHY WHILE LOOP (not IF)?                                  â”‚
      // â”‚                                                            â”‚
      // â”‚  After removing one character from left, window might      â”‚
      // â”‚  STILL be invalid if that character appears multiple times â”‚
      // â”‚                                                            â”‚
      // â”‚  Example: window = "aabc", k=2                             â”‚
      // â”‚  Remove 'a': "abc" â†’ still 3 distinct, need to continue!   â”‚
      // â”‚  Remove 'a': "bc" â†’ 2 distinct, now valid âœ…               â”‚
      // â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      while (freq.size > k) {
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // REMOVE character at left from window
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

        const leftChar = s[left];
        const leftCount = freq.get(leftChar)!;

        if (leftCount === 1) {
          // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          // IMPORTANT: If count becomes 0, DELETE the key!
          // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          //
          // This is how we track distinct count:
          // - map.size = distinct characters in window
          // - When count reaches 0, remove key â†’ size decreases
          //
          // Without this, map.size would never decrease!

          freq.delete(leftChar);
        } else {
          // Just decrement count
          freq.set(leftChar, leftCount - 1);
        }

        // Move left pointer forward
        left++;
      }

      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // STEP 3: UPDATE maxLength
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      //
      // After shrinking, window [left, right] is VALID (distinct â‰¤ k)
      // Current window length = right - left + 1

      const currentLength = right - left + 1;
      maxLength = Math.max(maxLength, currentLength);
    }

    return maxLength;
  }

  /**
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * DRY RUN - COMPLETE VISUALIZATION
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * Example: s = "eceba", k = 2, n = 5
   *
   * Initial: left = 0, maxLength = 0, freq = {}
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * right = 0: char = 'e'
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   *   ADD 'e': freq = {e:1}
   *   freq.size = 1, k = 2
   *   1 > 2? NO â†’ no shrinking needed
   *
   *   Window: [e]ceba
   *            â†‘
   *           L,R
   *
   *   maxLength = max(0, 0-0+1) = 1
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * right = 1: char = 'c'
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   *   ADD 'c': freq = {e:1, c:1}
   *   freq.size = 2, k = 2
   *   2 > 2? NO â†’ no shrinking needed
   *
   *   Window: [ec]eba
   *            â†‘â†‘
   *           L R
   *
   *   maxLength = max(1, 1-0+1) = 2
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * right = 2: char = 'e'
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   *   ADD 'e': freq = {e:2, c:1}
   *   freq.size = 2, k = 2
   *   2 > 2? NO â†’ no shrinking needed
   *
   *   Window: [ece]ba
   *            â†‘ â†‘
   *           L  R
   *
   *   maxLength = max(2, 2-0+1) = 3 â­
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * right = 3: char = 'b'
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   *   ADD 'b': freq = {e:2, c:1, b:1}
   *   freq.size = 3, k = 2
   *   3 > 2? YES âŒ â†’ SHRINK!
   *
   *   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   *   â”‚ WHILE LOOP - Shrink until valid                                        â”‚
   *   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   *   â”‚                                                                         â”‚
   *   â”‚ Iteration 1:                                                            â”‚
   *   â”‚   leftChar = s[0] = 'e'                                                 â”‚
   *   â”‚   freq[e] = 2 â†’ decrement to 1                                          â”‚
   *   â”‚   freq = {e:1, c:1, b:1}, size=3 > 2, continue                         â”‚
   *   â”‚   left = 1                                                              â”‚
   *   â”‚                                                                         â”‚
   *   â”‚ Iteration 2:                                                            â”‚
   *   â”‚   leftChar = s[1] = 'c'                                                 â”‚
   *   â”‚   freq[c] = 1 â†’ DELETE key 'c'                                          â”‚
   *   â”‚   freq = {e:1, b:1}, size=2 â‰¤ 2 âœ… STOP                                â”‚
   *   â”‚   left = 2                                                              â”‚
   *   â”‚                                                                         â”‚
   *   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   *   Window: ec[eb]a
   *              â†‘â†‘
   *             L R
   *
   *   maxLength = max(3, 3-2+1) = 3
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * right = 4: char = 'a'
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   *   ADD 'a': freq = {e:1, b:1, a:1}
   *   freq.size = 3, k = 2
   *   3 > 2? YES âŒ â†’ SHRINK!
   *
   *   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   *   â”‚ WHILE LOOP - Shrink until valid                                        â”‚
   *   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   *   â”‚                                                                         â”‚
   *   â”‚ Iteration 1:                                                            â”‚
   *   â”‚   leftChar = s[2] = 'e'                                                 â”‚
   *   â”‚   freq[e] = 1 â†’ DELETE key 'e'                                          â”‚
   *   â”‚   freq = {b:1, a:1}, size=2 â‰¤ 2 âœ… STOP                                â”‚
   *   â”‚   left = 3                                                              â”‚
   *   â”‚                                                                         â”‚
   *   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   *   Window: ece[ba]
   *               â†‘â†‘
   *              L R
   *
   *   maxLength = max(3, 4-3+1) = 3
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * FINAL RESULT: maxLength = 3 (substring "ece")
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * DRY RUN 2: s = "aababbcaacc", k = 2
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * right=0: 'a' â†’ freq={a:1}, size=1 â‰¤ 2 âœ…, len=1
   * right=1: 'a' â†’ freq={a:2}, size=1 â‰¤ 2 âœ…, len=2
   * right=2: 'b' â†’ freq={a:2,b:1}, size=2 â‰¤ 2 âœ…, len=3
   * right=3: 'a' â†’ freq={a:3,b:1}, size=2 â‰¤ 2 âœ…, len=4
   * right=4: 'b' â†’ freq={a:3,b:2}, size=2 â‰¤ 2 âœ…, len=5
   * right=5: 'b' â†’ freq={a:3,b:3}, size=2 â‰¤ 2 âœ…, len=6 â­
   *
   * right=6: 'c' â†’ freq={a:3,b:3,c:1}, size=3 > 2 âŒ
   *
   *   SHRINK:
   *   left=0: remove 'a' â†’ freq={a:2,b:3,c:1}, size=3, left=1
   *   left=1: remove 'a' â†’ freq={a:1,b:3,c:1}, size=3, left=2
   *   left=2: remove 'b' â†’ freq={a:1,b:2,c:1}, size=3, left=3
   *   left=3: remove 'a' â†’ freq={b:2,c:1}, size=2 â‰¤ 2 âœ…, left=4
   *
   *   Window: aaba[bbc]aacc, len=3
   *
   * right=7: 'a' â†’ freq={b:2,c:1,a:1}, size=3 > 2 âŒ
   *
   *   SHRINK:
   *   left=4: remove 'b' â†’ freq={b:1,c:1,a:1}, size=3, left=5
   *   left=5: remove 'b' â†’ freq={c:1,a:1}, size=2 â‰¤ 2 âœ…, left=6
   *
   *   Window: aababb[ca]acc, len=2
   *
   * right=8: 'a' â†’ freq={c:1,a:2}, size=2 â‰¤ 2 âœ…, len=3
   * right=9: 'c' â†’ freq={c:2,a:2}, size=2 â‰¤ 2 âœ…, len=4
   * right=10: 'c' â†’ freq={c:3,a:2}, size=2 â‰¤ 2 âœ…, len=5
   *
   * FINAL: maxLength = 6 ("aababb")
   *
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * WHY O(n) TIME COMPLEXITY?
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚                                                                            â”‚
   * â”‚  Each character is:                                                        â”‚
   * â”‚  - ADDED to window exactly ONCE (when right reaches it)                   â”‚
   * â”‚  - REMOVED from window AT MOST ONCE (when left passes it)                 â”‚
   * â”‚                                                                            â”‚
   * â”‚  Total operations: at most 2n = O(n)                                       â”‚
   * â”‚                                                                            â”‚
   * â”‚  Visual:                                                                   â”‚
   * â”‚  s = "a b c d e f"                                                         â”‚
   * â”‚       â†‘           â†‘                                                        â”‚
   * â”‚      left        right                                                     â”‚
   * â”‚                                                                            â”‚
   * â”‚  Both pointers only move FORWARD, never backward!                          â”‚
   * â”‚  - right: 0 â†’ 1 â†’ 2 â†’ ... â†’ n-1 (n moves)                                 â”‚
   * â”‚  - left:  0 â†’ ... â†’ n-1 at most (â‰¤n moves)                                â”‚
   * â”‚                                                                            â”‚
   * â”‚  Amortized: O(n)                                                           â”‚
   * â”‚                                                                            â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * KEY INSIGHT: MAP SIZE = DISTINCT COUNT
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   * â”‚                                                                            â”‚
   * â”‚  ADDING character:                                                         â”‚
   * â”‚  - If NEW: freq.set(char, 1) â†’ map.size INCREASES                         â”‚
   * â”‚  - If EXISTS: freq.set(char, count+1) â†’ map.size SAME                     â”‚
   * â”‚                                                                            â”‚
   * â”‚  REMOVING character:                                                       â”‚
   * â”‚  - If count > 1: freq.set(char, count-1) â†’ map.size SAME                  â”‚
   * â”‚  - If count == 1: freq.delete(char) â†’ map.size DECREASES                  â”‚
   * â”‚                                                                            â”‚
   * â”‚  CRITICAL: Must DELETE key when count becomes 0!                          â”‚
   * â”‚  Otherwise map.size won't reflect actual distinct count.                  â”‚
   * â”‚                                                                            â”‚
   * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   *
   *
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   * EDGE CASES
   * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   *
   * 1. k = 0: No characters allowed â†’ return 0
   *
   * 2. k >= distinct(s): Entire string is valid â†’ return n
   *
   * 3. All same characters: map.size always 1 â†’ return n
   *
   * 4. Each character unique: If k < n, max window = k
   */

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // TEST CASES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  export function runTests(): void {
    console.log(
      'ğŸ§ª Testing Longest Substring with At Most K Distinct - SLIDING WINDOW\n'
    );
    console.log('â•'.repeat(60) + '\n');

    const testCases: {
      s: string;
      k: number;
      expected: number;
      description: string;
    }[] = [
      // Examples from problem
      {
        s: 'aababbcaacc',
        k: 2,
        expected: 6,
        description: 'Example 1 - "aababb" is longest',
      },
      {
        s: 'abcddefg',
        k: 3,
        expected: 4,
        description: 'Example 2 - "bcdd" or "cdde"',
      },
      {
        s: 'eceba',
        k: 2,
        expected: 3,
        description: 'Example 3 - "ece" is longest',
      },

      // Edge cases
      {
        s: 'aaaa',
        k: 1,
        expected: 4,
        description: 'All same characters',
      },
      {
        s: 'a',
        k: 1,
        expected: 1,
        description: 'Single character',
      },
      {
        s: 'abc',
        k: 0,
        expected: 0,
        description: 'k=0, no chars allowed',
      },
      {
        s: '',
        k: 2,
        expected: 0,
        description: 'Empty string',
      },

      // More test cases
      {
        s: 'aabbcc',
        k: 2,
        expected: 4,
        description: '"aabb" or "bbcc"',
      },
      {
        s: 'aabbcc',
        k: 3,
        expected: 6,
        description: 'k=3, entire string valid',
      },
      {
        s: 'abcabcabc',
        k: 2,
        expected: 2,
        description: 'Repeating pattern, max 2 distinct',
      },
      {
        s: 'aaabbbccc',
        k: 2,
        expected: 6,
        description: '"aaabbb" or "bbbccc"',
      },
      {
        s: 'abaccc',
        k: 2,
        expected: 4,
        description: '"accc" is longest',
      },
    ];

    let passed = 0;
    let failed = 0;

    for (let i = 0; i < testCases.length; i++) {
      const { s, k, expected, description } = testCases[i];
      const result = lengthOfLongestSubstringKDistinct(s, k);
      const status = result === expected ? 'âœ… PASS' : 'âŒ FAIL';

      if (result === expected) {
        passed++;
      } else {
        failed++;
      }

      console.log(`Test ${i + 1}: ${status}`);
      console.log(`  Description: ${description}`);
      console.log(`  Input: s = "${s}", k = ${k}`);
      console.log(`  Expected: ${expected}`);
      console.log(`  Got: ${result}`);
      console.log();
    }

    console.log('â•'.repeat(60));
    console.log(`\nğŸ“Š Results: ${passed} passed, ${failed} failed\n`);

    if (failed === 0) {
      console.log('ğŸ‰ All tests passed! Sliding Window samajh aa gaya! ğŸš€');
      console.log('ğŸ“Š Complexity: Time O(n), Space O(k)');
      console.log('\nğŸ’¡ Key Pattern: Expand right, shrink left while invalid');
      console.log('ğŸ’¡ Key Insight: map.size = distinct count in window');
      console.log('ğŸ’¡ Critical: DELETE key when count becomes 0!');
    }
  }
}

// Execute tests
LongestSubstringAtMostKDistinctSlidingWindow.runTests();